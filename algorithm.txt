Algorithm for doing a synthetic seismogram (synthetic gather or synthetic zero offset gather or convolutional model)

Input: Frequency for source wavelet, depth model for P velocity and density (optional***;if not provided will be considered constant and equal to 1, so that density will not influence the final result).  

1)Calculate the acoustic impedance matrix: AI=velocity*density.
2)Calculate the reflection coefficients: RC=(AI[1:,:]-AI[:-1,:])/(AI[1:,:]+AI[:-1,:])
3)Convert** RC from depth to time, using the velocity matrix, obtain RC_time.Fill the first line of the RC and RC_time with zeros to maintain it with the same dimension as AI.
4)
5)Calculate the convolution of RC_time with wavelet. The result has the length: len(RC)+len(wavelet)-1
6)Cut len(wavelet)/2 from the beggining and from the end of the result. 

**Depth time (TWT - two way time) conversion
Input: P velocity model in depth, vertical discretization (dz,length between each line in the matrix-considered 1m if not given)
Output: matrix with the corresponding two way times for each depth

1)The first line is: time_depth[1,:]=2*dz/velocity[1,:]
2)Second line: time_depth[2,:]=time_depth[1,:]+2*dz/velocity[2,:]
3)time_depth[n,:]=time_depth[n-1,:]+2*dz/velocity[n,:]


***Yilmaz, Ch.2, pg.165:"From well-log measurements, we find that the vertical density gradient often is much smaller than the vertical velocity gradient.Therefore, we often assume that the impedance contrast between rock layers is essentially due to the velocity contrast, only."
